#!/usr/bin/env bash

termux_fix_tpm() {
  find ~/.tmux/plugins/* ! -path '*.git*' -type f -exec termux-fix-shebang '{}' \;
  # echo ~/.tmux/plugins/{tpm/tpm,tpm/bin/*,tpm/bindings/*,tpm/scripts/**/*.sh,tmux-sensible/sensible.tmux}
  # termux-fix-shebang ~/.tmux/plugins/{tpm/tpm,tpm/bin/*,tpm/bindings/*,tpm/scripts/**/*.sh,tmux-sensible/sensible.tmux}
}

_post_install() {
  termux_fix_tpm
}

_main() {
  # https://termux.com/storage.html
  if [[ ! -d "$HOME/storage" ]]
  then log "Termux setup storage..."
    run termux-setup-storage
  fi

  directory "$state" "$HOME/.termux"

  symlink "$state" --prefix "$prefix" --path .termux/*
}
