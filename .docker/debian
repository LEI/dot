# vi: ft=Dockerfile
FROM debian

ENV OS linux
ENV ARCH amd64
ENV USER docker
ENV DEBIAN_FRONTEND noninteractive

RUN apt-get update -qq -y && \
apt-get install -qq --no-install-suggests --no-install-recommends -y \
apt-utils \
ca-certificates \
git \
locales \
sudo

RUN ./scripts/setup-lang.sh
RUN ./scripts/setup-user.sh $USER --password '' --groups staff

COPY ./dist/${OS}_${ARCH}/dot /usr/local/bin/dot

USER $USER

WORKDIR /home/$USER

COPY ./scripts scripts
COPY ./.dot.yml .dot.yml

# Restore interactive
ENV DEBIAN_FRONTEND newt

#RUN dot install --packages --sudo

ENTRYPOINT ["/bin/bash"]
