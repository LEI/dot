# vi: ft=Dockerfile
FROM centos

ENV OS linux
ENV ARCH amd64
ENV USER docker

RUN yum update --assumeyes && \
yum install --assumeyes --quiet \
ca-certificates \
git

# RUN locale-gen

COPY ./dist/${OS}_${ARCH}/dot /usr/local/bin/dot

RUN useradd --create-home --shell /bin/bash $USER
RUN echo "$USER:$USER" | chpasswd
RUN echo '%sudo ALL=(ALL) NOPASSWD: ALL' > /etc/sudoers.d/sudo
# RUN adduser $USER sudo && adduser $USER staff

USER $USER

# $HOME
WORKDIR /home/$USER

COPY ./scripts /root/scripts
COPY ./.dot.yml /root/.dot.yml

RUN dot install --packages --sudo

ENTRYPOINT ["/bin/bash"]
